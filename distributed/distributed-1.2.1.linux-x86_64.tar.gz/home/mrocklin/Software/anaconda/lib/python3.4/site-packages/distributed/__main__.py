import paramiko

from sys import argv

center_addr = argv[1]
addresses = argv[2:]


ssh = paramiko.SSHClient()
ssh.set_missing_host_key_policy(paramiko.AutoAddPolicy())
ssh.connect(center_addr)
center_channel = ssh.invoke_shell()
center_channel.recv(1000)

center_channel.send('dcenter\n')
print(center_channel.recv(1000))

workers = []
for addr in addresses:
    ssh = paramiko.SSHClient()
    ssh.set_missing_host_key_policy(paramiko.AutoAddPolicy())
    ssh.connect(addr)
    channel = ssh.invoke_shell()
    workers.append(channel)

for worker in workers:
    worker.send('dworker %s:8787\n' % center_addr)

"""
for worker in workers:
    print(worker.recv(1000))
"""
